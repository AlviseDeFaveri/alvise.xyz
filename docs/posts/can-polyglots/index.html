<!doctype html><html lang=en-us data-anim=none><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>CAN polyglots: A fancy way of attacking car networks - alvise.xyz</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><link rel=stylesheet href=/main.min.9259c34bb6449a565bee578161a8e42afae4cc08787c53977e75758fd1506f67.css media=all><script type=text/javascript>var storedTheme=localStorage.getItem('theme')||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");if(storedTheme){document.documentElement.setAttribute('data-theme',storedTheme)}</script><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><meta property="og:title" content="CAN polyglots: A fancy way of attacking car networks"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://www.alvise.xyz/posts/can-polyglots/"><meta property="og:image" content="https://www.alvise.xyz/posts/can-polyglots/img/UARTpkt-cut_huaeb2b015ef5f965df45a75adc9867937_70281_400x0_resize_box_2.png"><meta property="article:published_time" content="2022-11-25T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.alvise.xyz/posts/can-polyglots/img/UARTpkt-cut_huaeb2b015ef5f965df45a75adc9867937_70281_400x0_resize_box_2.png"><meta name=twitter:title content="CAN polyglots: A fancy way of attacking car networks"><meta name=twitter:description content="Some months ago, I wrote a Twitter thread about some CAN bus hacking shenanigans I did for my master thesis. I thought it would be interesting to share it on the blog too, so here it is."></head><body class=terminal><div class="container top-container"><div class=terminal-nav><header class=terminal-logo><a class=home-btn href=https://www.alvise.xyz/>~/</a></header><nav class=terminal-menu><ul vocab="https://schema.org/" typeof="BreadcrumbList"><li><span class=separator></span></li><li><button id=theme-toggle>ðŸŒ“ï¸Ž</button></li></ul></nav></div></div><div class="container main-container"><h1 class=post-title>CAN polyglots: A fancy way of attacking car networks</h1><div class="postpage-date date">ðŸ“† 25 Nov. 2022 â€¢ âŒš ~2 min.</div><div class=post-content><figure><img src=img/UARTpkt-cut.png alt="This signal (UART TX) is both a sequence of UART packets and a CAN frame. It&amp;rsquo;s a CUART!" width=1000px><figcaption><p>This signal (UART TX) is both a sequence of UART packets and a CAN frame. It&rsquo;s a CUART!</p></figcaption></figure><p>Some months ago, I wrote a <a href=https://twitter.com/HBitmasks/status/1446813123667759106>Twitter thread</a> about some CAN bus hacking shenanigans I did for my master thesis (which got retweeted by <a href=https://twitter.com/angealbertini>@angealbertini</a> - senpai noticed me! ðŸ¥º). I thought it would be interesting to share it on the blog too, so here it is.</p><p>CAN bus is a standard protocol used inside vehicles to interconnect control units, which makes it a very interesting target for security research. A lot of very cool stuff has already been done on the subject, most famously by the <a href=https://www.wired.com/2015/07/hackers-remotely-kill-jeep-highway/>godfathers of car hacking</a> (Miller & Valasek) and by the awesome <a href=https://kentindell.github.io/>Ken Tindell</a>, but some of the most sophisticated low-level attacks, like the <a href=https://maggi.cc/publication/palanca_candos_2017/palanca_candos_2017.pdf>Selective DoS attack</a>, have still some limitations, e.g. they require physical access to the CAN bus under many circumstances.</p><p>What we did, in a nutshell, was discovering a nice little trick for performing low-level attacks on the CAN bus without modifying the microcontroller: we basically bypassed the CAN controller from software, and then injected/read bits on the bus using an SPI, I2C, UART or ADC peripheral (and the list goes on) connected to the same physical pins.</p><p>The idea is really simple, but itâ€™s also effective, and doesnâ€™t have many of the limitations of plain <a href="https://www.youtube.com/watch?v=sMmc0hSi5rs&ab_channel=AdrianCrenshaw">bitbanging</a> (or even state of the art <a href=https://ieeexplore.ieee.org/document/9519391>techniques</a>). We were even able to read and write complete CAN frames using a completely different peripheral, in some specific cases, which is what you can see in the figure.</p><p>Polyglots are <em>everywhere</em> (and they are awesome)!</p><p>I had a lot of fun doing this, and I hope you can enjoy that too by taking a look at the thread.</p><p>Have a nice read!</p><hr><p><em>Update</em>: After many months of back and forth, we were able to get this published at the ACM CCS &lsquo;22 conference! This is a very cool achievement, for which I am super grateful. You can find the full paper <a href=https://dl.acm.org/doi/abs/10.1145/3548606.3560618>here</a> if youâ€™re interested.</p></div><footer class=footer><p>Built with
<a href=https://gohugo.io/>Hugo</a> and
<a href=https://github.com/mrmierzejewski/hugo-theme-console/>Console</a></p></footer></div></body><script type=text/javascript>var toggle=document.getElementById("theme-toggle");toggle.onclick=function(){document.documentElement.setAttribute("data-anim","fast")
var currentTheme=document.documentElement.getAttribute("data-theme");var targetTheme=currentTheme==="light"?"dark":"light";document.documentElement.setAttribute("data-theme",targetTheme)
localStorage.setItem("theme",targetTheme);};</script></html>