<!DOCTYPE html>
<html lang="en-us" data-anim="none">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Dynamic Linking Infographic - alvise.xyz </title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <link rel="stylesheet" href="/main.min.6703cccad1ab38a45b183463940ffeed13f4adb6334e5afddec454a5f31b57ba.css" media="all">

    
    <script type="text/javascript">
      var storedTheme = localStorage.getItem('theme') || (window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light");
      if (storedTheme) {
        document.documentElement.setAttribute('data-theme', storedTheme)
      } else {
        document.documentElement.setAttribute('data-theme', 'dark')
      }
    </script>

    
      <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
       <meta property="og:title" content="Dynamic Linking Infographic" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.alvise.xyz/sketches/dynamic-linking/" /><meta property="article:published_time" content="2023-01-14T00:00:00+00:00" />



<meta name="twitter:title" content="Dynamic Linking Infographic"/>
<meta name="twitter:description" content="What happens when your code calls printf()? And what&rsquo;s up with all that .got.plt stuff that you see when you decompile a binary? Here are some sketches I drew to help me remember this kind of stuff."/>

</head>
<body class="terminal">
      <div class="container top-container">
        <div class="terminal-nav">
          <header class="terminal-logo">

            
          </header>
          
          <nav class="terminal-menu">
            <ul vocab="https://schema.org/" typeof="BreadcrumbList">
              
              
              <a class=home-btn href="https://www.alvise.xyz/">~/</a>
              
              <li class="separator"></li>
              <li><button id="theme-toggle">ðŸŒ“ï¸Ž</button></li>
            </ul>
          </nav>
        </div>
    </div>

    <div class="container main-container" >
        
<h1>Dynamic Linking Infographic</h1>
<p>What happens when your code calls <code>printf()</code>? And what&rsquo;s up with all that <code>.got.plt</code> crap that you see when you decompile a binary? Here are some sketches I drew to help me remember this kind of stuff.</p>
<p><a href="img/dynamic-linking.png">Full Infographic</a>.</p>
<!-- raw HTML omitted -->
<h3 id="intro-dynamic-linking">Intro: Dynamic Linking</h3>
<p>First of all, we need to understand the difference between a <strong>statically linked</strong> binary and a dynamically linked one:</p>
<ul>
<li>A statically linked binary contains all the program&rsquo;s code <em>and the library code</em> already linked together in a single binary blob.</li>
<li>In many cases, we don&rsquo;t really want to compile the whole libc inside each of our binaries. In order to be <em>dynamically linked</em>, the binary contains only the user code, together with some <em>relocation information</em> that are used at runtime to resolve the location of library functions on the host machine.</li>
</ul>
<!-- raw HTML omitted -->
<figure class="invertible"
style="max-width:40em;
"><img src="img/dyn-linking-2.svg"style=";;;
         "
    />
</figure>

<h3 id="the-dynamic-linker">The Dynamic Linker</h3>
<p>The Dynamic Linker is the piece of code in charge of linking stuff at runtime (duh).</p>
<figure class="invertible"
style="max-width:40em;
"><img src="img/dynamic-linker.png"style=";;;
         "
    />
</figure>

<h3 id="linker-related-elf-sections">Linker-Related ELF sections</h3>
<p>Dynamically linked binaries have a bunch of information that is used to link them together:</p>
<ul>
<li>Libraries (<code>.so</code>, shared-object files) keep a table of <em>exported</em> symbols, with their names and addresses.</li>
<li>Programs that want to link against those libraries expose a list of <em>imported</em> symbols, which have a corresponding entry in the PLT (Procedure Linkage Table). The <strong>PLT</strong> entry is executed every time we call the library function, and this will cause the code to jump to an address specified in the <strong>GOT</strong> (Global Offset Table).</li>
</ul>
<figure class="invertible"
style="max-width:40em;
"><img src="img/dyn-linking-sections.svg"style=";;;
         "
    />
</figure>

<!-- raw HTML omitted -->
<h3 id="lazy-loading">Lazy Loading</h3>
<p>The procedure of jumping to the library function and finding the appropriate address is described below:</p>
<figure class="invertible"
style="max-width:40em;
"><img src="img/relocations.png"style=";;;
         "
    />
</figure>

<h3 id="bonus-linking-flags">Bonus: Linking Flags</h3>
<p>Some flags can be specified to avoid the &ldquo;lazy&rdquo; part of dynamic loading.</p>
<figure class="invertible"
style="max-width:25em;
"><img src="img/relro.png"style=";;;
         "
    />
</figure>



        <footer class="footer">
  <p>Built with
    <a href="https://gohugo.io/">Hugo</a> and
    <a href="https://github.com/mrmierzejewski/hugo-theme-console/">Console</a>
  </p>
</footer>

    </div>
  </body>





<script type="text/javascript">
  var toggle = document.getElementById("theme-toggle");

  toggle.onclick = function() {
    document.documentElement.setAttribute("data-anim", "fast")

    var currentTheme = document.documentElement.getAttribute("data-theme");
    var targetTheme = currentTheme === "light" ? "dark" : "light";

    document.documentElement.setAttribute("data-theme", targetTheme)
    localStorage.setItem("theme", targetTheme);
  };
</script>
</html>
